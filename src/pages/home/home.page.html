<ion-header>
    <ion-navbar color="primary">
        <button ion-button menuToggle item-left>
            <ion-icon name="menu"></ion-icon>
        </button>

        <ion-title>Portada</ion-title>

    </ion-navbar>

     <ion-toolbar no-border-top>
        <ion-segment secondary [(ngModel)]="orderFilter">
            <ion-segment-button value="notAssigned">
                Sin Asignar
            </ion-segment-button>
            <ion-segment-button value="assigned">
                Asignados
            </ion-segment-button>
        </ion-segment>
    </ion-toolbar>
</ion-header>

<ion-content>
    <div [ngSwitch]="orderFilter" >
        <ion-grid *ngSwitchCase="'notAssigned'">
            <ion-row >
                <ng-container *ngFor="let codsPostales of orders">
                    <ion-col col-sm-4 col-md-6 col-lg-4 col-xl-3 *ngIf="!codsPostales.pedido.repartidor && !codsPostales.pedido.fechaEntrega">

                        <ion-card>
                            <ion-card-header>
                                {{codsPostales.codPos}}
                            </ion-card-header>
                            
                            <ion-list >
                                <ion-item-group>
                                    <ion-item-divider >
                                    <!--TODO: Montar la lógica del divisor por dirección y el botoncillo de debajo también-->
                                    </ion-item-divider>
                                
                                    <ng-container *ngFor="let item of codsPostales.pedido">
                                        <button ion-item icon-right outline *ngIf="!item.repartidor && !item.fechaEntrega" (click)="goToOrder($event, item)">
                                            <ion-row>
                                                <ion-col col-10>
                                                    <h2>Remitente: {{item.remitente}}</h2>
                                                    <h3>Dirección: {{item.direccion}}</h3>
                                                    <p>Fech. Entrada: {{item.fechaEntradaAlmacen | date:'d/MM/yy'}} - {{item.fechaEntradaAlmacen | date:'shortTime'}}</p>
                                                    
                                                </ion-col>
                                                <ion-col col-2>
                                                    <br>
                                                    <ion-icon *ngIf="item.urgente" name="alert"></ion-icon>
                                                </ion-col>
                                            </ion-row>
                                        </button>
                                    </ng-container>

                                </ion-item-group>
                            </ion-list>

                        </ion-card>

                    </ion-col>
                </ng-container>
                
            </ion-row>
        </ion-grid>

        <ion-grid *ngSwitchCase="'assigned'">
            <ion-row>
                <ng-container *ngFor="let item of orders">
                    <ion-col col-sm-4 col-md-6 col-lg-4 col-xl-3 *ngIf="item.repartidor && !item.fechaEntrega" >

                        <ion-card (click)="goToOrder($event, item)">
                            <ion-card-header>
                                {{item.$key}}
                            </ion-card-header>
                            
                            <ion-card-content>
                                <ion-row>
                                    <ion-col col-10>
                                        <h2>Rem: {{item.remitente}}</h2>
                                        <p>Paquetes: {{item.numPaquetes}}</p>
                                        <p>Peso: {{item.peso}}</p>
                                        <p>Fech. Entrada: {{item.fechaEntradaAlmacen | date:'d/MM/yy'}} - {{item.fechaEntradaAlmacen | date:'shortTime'}}</p>
                                    </ion-col>

                                    <ion-col col-2>
                                        <ion-buttons end>
                                            <button ion-button icon-only outline *ngIf="item.urgente">
                                                <ion-icon name="alert"></ion-icon>
                                            </button>
                                        </ion-buttons>
                                    </ion-col>
                                </ion-row>
                            </ion-card-content>
                        </ion-card>

                    </ion-col>
                </ng-container>
            </ion-row>
        </ion-grid>
        
    </div>
        

</ion-content>